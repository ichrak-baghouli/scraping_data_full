name: Odoo CI/CD
on: [push, pull_request]

jobs:
  quality:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: find custom_addons -name "*.py" -exec python -m py_compile {} \;

  build:
    runs-on: ubuntu-latest
    needs: quality
    steps:
      - uses: actions/checkout@v4
      - run: echo "FROM odoo:16.0" > Dockerfile

  test:
    runs-on: ubuntu-latest
    needs: build
    steps:
      - run: echo "Tests passed" > report.txt

  deploy:
    runs-on: ubuntu-latest
    needs: test
    steps:
      - run: echo "Deployed to ${{ github.ref == 'refs/heads/master' && 'production' || 'staging' }}"